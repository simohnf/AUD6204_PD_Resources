#N canvas 0 23 938 624 10;
#X obj 145 324 +~ 1;
#X obj 46 117 f 50, f 22;
#X obj 46 93 inlet;
#X text 30 74 bang for grain;
#X obj 237 35 inlet;
#X text 178 75 grain length (ms);
#X text 297 77 playback speed;
#X text 416 75 grain start;
#X obj 46 434 *~, f 17;
#X obj 46 575 outlet~;
#X text 806 80 pan;
#X obj 46 549 *~, f 17;
#X obj 311 575 outlet~;
#X obj 311 549 *~, f 39;
#N canvas 0 23 450 300 panning 0;
#N canvas 0 23 450 300 cos_env 0;
#X obj 103 86 inlet~;
#X obj 103 150 cos~;
#X obj 103 129 -~ 0.25;
#X obj 103 171 outlet~;
#X obj 103 108 *~ 0.5;
#X text 149 132 offset by -90 degrees so we start at 0;
#X connect 0 0 4 0;
#X connect 1 0 3 0;
#X connect 2 0 1 0;
#X connect 4 0 2 0;
#X restore 113 180 pd cos_env;
#X obj 124 147 sig~;
#N canvas 0 23 450 300 cos_env 0;
#X obj 103 86 inlet~;
#X obj 103 150 cos~;
#X obj 103 129 -~ 0.25;
#X obj 103 171 outlet~;
#X obj 103 108 *~ 0.5;
#X text 149 132 offset by -90 degrees so we start at 0;
#X connect 0 0 4 0;
#X connect 1 0 3 0;
#X connect 2 0 1 0;
#X connect 4 0 2 0;
#X restore 197 183 pd cos_env;
#X obj 208 150 sig~;
#X obj 186 25 inlet;
#X obj 186 46 * 0.5;
#X obj 113 201 outlet~;
#X obj 197 204 outlet~;
#X text 238 150 0 ---> 0.5;
#X obj 124 97 * -1;
#X obj 124 118 + 0.5;
#X text 59 146 0.5 --> 0;
#X connect 0 0 6 0;
#X connect 1 0 0 0;
#X connect 2 0 7 0;
#X connect 3 0 2 0;
#X connect 4 0 5 0;
#X connect 5 0 3 0;
#X connect 5 0 9 0;
#X connect 9 0 10 0;
#X connect 10 0 1 0;
#X restore 496 362 pd panning;
#X obj 496 340 f 0.5;
#X text 580 363 as for the amplitude envelope;
#X text 570 351 I use exactly the same logic for panning;
#X text 513 81 fileSize in samples;
#X text 177 323 <--- according to tabread~ helpfile;
#X text 215 336 the indices begin at 1 ???;
#X text 202 15 grain parameters;
#X obj 46 138 t f b b, f 21;
#N canvas -1240 595 723 346 position_wrapround_logic 0;
#X obj 109 75 inlet~;
#X obj 219 75 inlet;
#X obj 343 75 inlet;
#X obj 268 183 wrap~;
#X obj 109 204 +~, f 27;
#X obj 343 99 - 2;
#X text 366 100 tabread4~ only counts file size a nSample-2 ????;
#X obj 220 118 f, f 21;
#X obj 109 150 +~, f 17;
#X text 90 51 raw position in;
#X text 204 51 bag on next grain;
#X text 337 51 fliesize in samples;
#X obj 109 225 outlet~;
#X obj 220 141 sig~ 1;
#X obj 109 183 expr~ $v1 % $v2, f 19;
#X connect 0 0 8 0;
#X connect 1 0 7 0;
#X connect 2 0 5 0;
#X connect 3 0 4 1;
#X connect 4 0 12 0;
#X connect 5 0 7 1;
#X connect 7 0 13 0;
#X connect 8 0 3 0;
#X connect 8 0 14 0;
#X connect 13 0 14 1;
#X connect 13 0 8 1;
#X connect 14 0 4 0;
#X restore 145 267 pd position_wrapround_logic;
#X f 9;
#N canvas 617 50 1249 601 grain_play_logic 0;
#X obj 449 61 inlet;
#X obj 450 290 *~, f 12;
#X obj 449 160 vline~;
#X obj 552 135 * 44.1;
#X text 594 136 Remember: tabread4~ works in sample position not ms
;
#X text 205 122 vline~ expects timing in ms;
#X text 174 288 read from sample 0 --> grainlength in samples;
#X text 151 137 jump to 0 \, then go to one over grain length (ms)
;
#X obj 450 311 +~, f 28;
#X obj 613 281 f;
#X obj 725 253 * 44.1;
#X text 767 254 Remember: tabread4~ works in sample position not ms
;
#X text 411 164 0-->1;
#X text 632 303 + x samples changes the starting point (e.g. + 100
\, instead of counting 0 \, 1 \, 2 \, 3 \, 4... it would count 100
\, 101 \, 102 \, 103 \, 104 \, ...etc);
#X obj 449 248 *~;
#X obj 476 222 sig~ 1;
#X text 75 212 we can change speed (and pitch!!!) of play back by multiply
our 0--->1 ramp by something;
#X text 73 262 e.g. *0.5 ==> read 1/2 the number of samples in the
same time \, i.e. read half speed and pitch;
#X text 71 237 e.g. *2 ==> read 2 times the number of samples in the
same time \, i.e. read double speed and pitch;
#X obj 479 201 f 1, f 20;
#X obj 449 110 t f f b b, f 25;
#X obj 616 188 inlet;
#X obj 718 223 inlet;
#X text 613 169 playback speed;
#X text 691 205 grainStart;
#X obj 374 502 outlet~;
#X text 326 533 amplitude envelope;
#X obj 450 332 outlet~;
#X text 446 355 sample index;
#X obj 785 355 inlet;
#X text 758 337 envelope type;
#N canvas 0 23 413 281 env_logic 0;
#X obj 178 40 inlet~;
#N canvas 0 23 450 300 cos_env 0;
#X obj 103 86 inlet~;
#X obj 103 150 cos~;
#X obj 103 129 -~ 0.25;
#X obj 103 171 outlet~;
#X obj 103 108 *~ 0.5;
#X text 149 132 offset by -90 degrees so we start at 0;
#X text 49 23 I use the ramp to read through 90 degrees of a cosine
;
#X text 77 36 this gives a smooth amplitude envelope;
#X connect 0 0 4 0;
#X connect 1 0 3 0;
#X connect 2 0 1 0;
#X connect 4 0 2 0;
#X restore 120 156 pd cos_env;
#X obj 160 111 == 0;
#X obj 118 99 *~ 1;
#X obj 265 64 inlet;
#X obj 165 217 outlet~;
#X obj 255 112 == 1;
#N canvas 0 23 598 381 tri_env 0;
#X obj 103 41 inlet~;
#X obj 103 171 outlet~;
#X obj 103 62 *~ 10;
#X obj 103 128 expr~ if($v1<=1 \, $v1 \, (9-($v1-1))/9);
#X connect 0 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 1 0;
#X restore 201 158 pd tri_env;
#X obj 205 179 *~ 0;
#X obj 118 124 *~ 0;
#X obj 277 180 *~ 0;
#X obj 306 128 == 2;
#N canvas 0 23 598 381 rev_env 0;
#X obj 103 41 inlet~;
#X obj 103 171 outlet~;
#X obj 103 62 *~ 20;
#X obj 103 128 expr~ if($v1<=19 \, ($v1/19) \, (20-$v1) );
#X connect 0 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 1 0;
#X restore 279 160 pd rev_env;
#X connect 0 0 3 0;
#X connect 0 0 7 0;
#X connect 0 0 12 0;
#X connect 1 0 5 0;
#X connect 2 0 9 1;
#X connect 3 0 9 0;
#X connect 4 0 2 0;
#X connect 4 0 6 0;
#X connect 4 0 11 0;
#X connect 6 0 8 1;
#X connect 7 0 8 0;
#X connect 8 0 5 0;
#X connect 9 0 1 0;
#X connect 10 0 5 0;
#X connect 11 0 10 1;
#X connect 12 0 10 0;
#X restore 298 404 pd env_logic;
#X msg 449 136 0 \, 1 \$1 \, 0 0 \$1;
#X obj 766 384 i;
#X connect 0 0 20 0;
#X connect 1 0 8 0;
#X connect 2 0 14 0;
#X connect 2 0 31 0;
#X connect 3 0 1 1;
#X connect 8 0 27 0;
#X connect 9 0 8 1;
#X connect 10 0 9 1;
#X connect 14 0 1 0;
#X connect 15 0 14 1;
#X connect 19 0 15 0;
#X connect 20 0 32 0;
#X connect 20 1 3 0;
#X connect 20 2 19 0;
#X connect 20 3 9 0;
#X connect 20 3 33 0;
#X connect 21 0 19 1;
#X connect 22 0 10 0;
#X connect 29 0 33 1;
#X connect 31 0 25 0;
#X connect 32 0 2 0;
#X connect 33 0 31 1;
#X restore 46 218 pd grain_play_logic;
#X f 11;
#X text 640 586 sjf \, SAE London \, 2020;
#X obj 145 356 tabread4~ \$1;
#X text 598 417 the name of the array the sample is loaded in;
#X text 600 399 this patch expects 1 argument:;
#X text 681 78 vol;
#X obj 145 377 *~, f 35;
#X obj 378 357 f 1;
#X obj 237 57 unpack 0 0 0 0 0 0 0, f 115;
#X text 889 76 env;
#X connect 0 0 26 0;
#X connect 1 0 22 0;
#X connect 2 0 1 0;
#X connect 4 0 32 0;
#X connect 8 0 11 0;
#X connect 8 0 13 0;
#X connect 11 0 9 0;
#X connect 13 0 12 0;
#X connect 14 0 11 1;
#X connect 14 1 13 1;
#X connect 15 0 14 0;
#X connect 22 0 24 0;
#X connect 22 1 23 1;
#X connect 22 2 15 0;
#X connect 22 2 31 0;
#X connect 23 0 0 0;
#X connect 24 0 8 0;
#X connect 24 1 23 0;
#X connect 26 0 30 0;
#X connect 30 0 8 1;
#X connect 31 0 30 1;
#X connect 32 0 1 1;
#X connect 32 1 24 1;
#X connect 32 2 24 2;
#X connect 32 3 23 2;
#X connect 32 4 31 1;
#X connect 32 5 15 1;
#X connect 32 6 24 3;
