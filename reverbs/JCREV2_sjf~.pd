#N canvas 0 57 826 507 12;
#X obj 73 124 inlet~;
#X text 188 151 3 * allpass;
#X text 392 371 Based on John Chowning's JCREV;
#X text 328 316 4 * feedback comb filters;
#X obj 34 463 outlet~;
#X obj 143 463 outlet~;
#X text 392 390 https://ccrma.stanford.edu/~jos/pasp/Schroeder_Reverberators.html#eq:APdef \; (Delay times in those diagrams are in samples so here I have set the delaytimes in ms ) \; In this version there are lowpass filters within the feedback combfilters as per https://github.com/thestk/stk/blob/master/include/JCRev.h;
#X obj 17 37 hsl 162 19 0 1 0 0 \$0-size \$0-size size 10 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 17 56 hsl 162 19 0 1 0 0 \$0-damping \$0-damping damping 10 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 297 283 r~ \$0-dampingSig;
#X obj 184 283 r~ \$0-sizeSig;
#N canvas 353 378 342 455 3*ap 0;
#X obj 37 37 inlet~;
#X obj 37 119 ../filters/allpass_sjf~ 13.88 0.7;
#X obj 37 230 ../filters/allpass_sjf~ 4.52 0.7;
#X obj 37 345 ../filters/allpass_sjf~ 1.48 0.7;
#X obj 37 369 outlet~;
#X obj 120 17 r \$0-load;
#X obj 120 41 0;
#X obj 120 65 tabread \$0-apDelays;
#X obj 108 147 r \$0-load;
#X obj 108 195 tabread \$0-apDelays;
#X obj 108 171 1;
#X obj 110 256 r \$0-load;
#X obj 110 304 tabread \$0-apDelays;
#X obj 110 280 2;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 7 0 1 1;
#X connect 8 0 10 0;
#X connect 9 0 2 1;
#X connect 10 0 9 0;
#X connect 11 0 13 0;
#X connect 12 0 3 1;
#X connect 13 0 12 0;
#X restore 73 148 pd 3*ap;
#N canvas 382 407 450 300 load 0;
#X obj 30 40 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 30 88 s \$0-load;
#N canvas 589 287 714 399 combDelays 0;
#X obj 47 12 inlet;
#X obj 47 356 array set \$0-combDelays;
#X obj 150 139 list split 1;
#X obj 225 199 list;
#X obj 150 163 t b f;
#X obj 150 228 expr 1000*$f1/44100;
#X text 287 230 convert to ms;
#X obj 47 37 t b b b, f 55;
#X msg 572 265 set;
#X msg 150 268 add2 \$1;
#X msg 47 318 25.3061 30.7483 32.2449 36.6667;
#X text 332 75 comb delay times in samples;
#X msg 155 104 1116 1356 1422 1617;
#X text 300 101 values copied from https://github.com/thestk/stk/blob/master/src/JCRev.cpp;
#X connect 0 0 7 0;
#X connect 2 0 4 0;
#X connect 2 1 3 1;
#X connect 3 0 2 0;
#X connect 4 0 3 0;
#X connect 4 1 5 0;
#X connect 5 0 9 0;
#X connect 7 0 10 0;
#X connect 7 1 12 0;
#X connect 7 2 8 0;
#X connect 8 0 10 0;
#X connect 9 0 10 0;
#X connect 10 0 1 0;
#X connect 12 0 2 0;
#X restore 9 146 pd combDelays;
#X obj 114 203 array define \$0-combDelays 4;
#X obj 115 229 array define \$0-apDelays 3;
#N canvas 589 287 714 399 apDelays 0;
#X obj 47 12 inlet;
#X obj 150 139 list split 1;
#X obj 225 199 list;
#X obj 150 163 t b f;
#X obj 150 228 expr 1000*$f1/44100;
#X text 287 230 convert to ms;
#X obj 47 37 t b b b, f 55;
#X msg 572 265 set;
#X msg 150 268 add2 \$1;
#X msg 47 318 5.10204 7.73243 10;
#X text 300 101 values copied from https://github.com/thestk/stk/blob/master/src/JCRev.cpp;
#X text 332 75 allpass delay times in samples;
#X obj 47 356 array set \$0-apDelays;
#X msg 155 104 225 341 441;
#X connect 0 0 6 0;
#X connect 1 0 3 0;
#X connect 1 1 2 1;
#X connect 2 0 1 0;
#X connect 3 0 2 0;
#X connect 3 1 4 0;
#X connect 4 0 8 0;
#X connect 6 0 9 0;
#X connect 6 1 13 0;
#X connect 6 2 7 0;
#X connect 7 0 9 0;
#X connect 8 0 9 0;
#X connect 9 0 12 0;
#X connect 13 0 1 0;
#X restore 154 129 pd apDelays;
#X obj 29 18 loadbang;
#X obj 30 64 t b b b, f 34;
#X obj 265 87 \$0;
#X msg 265 111 \; \$1-size 0.5 \; \$1-damping 0.5 \; \$1-dsp 0;
#X connect 0 0 7 0;
#X connect 6 0 0 0;
#X connect 7 0 1 0;
#X connect 7 1 2 0;
#X connect 7 1 5 0;
#X connect 7 2 8 0;
#X connect 8 0 9 0;
#X restore 481 193 pd load;
#N canvas 411 436 450 300 parameters 0;
#X floatatom 61 46 5 0 0 0 - - - 0;
#X obj 61 166 pack 0 5;
#X obj 61 190 line~;
#X obj 61 22 r \$0-size;
#X obj 61 214 s~ \$0-sizeSig;
#X floatatom 180 46 5 0 0 0 - - - 0;
#X obj 180 173 pack 0 5;
#X obj 180 197 line~;
#X obj 180 22 r \$0-damping;
#X obj 180 221 s~ \$0-dampingSig;
#X obj 61 69 min 1;
#X obj 180 69 min 1;
#X obj 180 93 max 0;
#X obj 61 93 max 0;
#X obj 61 117 * 9.5;
#X obj 61 141 + 0.5;
#X obj 180 117 * 0.6;
#X obj 180 141 + 0.3;
#X connect 0 0 10 0;
#X connect 1 0 2 0;
#X connect 2 0 4 0;
#X connect 3 0 0 0;
#X connect 5 0 11 0;
#X connect 6 0 7 0;
#X connect 7 0 9 0;
#X connect 8 0 5 0;
#X connect 10 0 13 0;
#X connect 11 0 12 0;
#X connect 12 0 16 0;
#X connect 13 0 14 0;
#X connect 14 0 15 0;
#X connect 15 0 1 0;
#X connect 16 0 17 0;
#X connect 17 0 6 0;
#X restore 481 232 pd parameters;
#X obj 73 316 clone RevComb_sjf~ 4 \$0;
#N canvas 556 572 450 300 decorrelation 0;
#X obj 112 37 inlet~;
#X obj 112 87 delwrite~ \$0-output 100;
#X obj 28 122 delread~ \$0-output 46;
#X obj 137 157 delread~ \$0-output 57;
#X text 197 115 Decorrelation delayLines;
#X obj 28 146 outlet~;
#X obj 137 181 outlet~;
#X connect 0 0 1 0;
#X connect 2 0 5 0;
#X connect 3 0 6 0;
#X restore 73 340 pd decorrelation;
#X obj 536 20 r \$0-dsp;
#X obj 536 53 switch~;
#X obj 187 56 tgl 19 0 \$0-dsp \$0-dsp on 2 10 0 10 #fcfcfc #000000 #000000 0 1;
#X connect 0 0 11 0;
#X connect 9 0 14 2;
#X connect 10 0 14 1;
#X connect 11 0 14 0;
#X connect 14 0 15 0;
#X connect 15 0 4 0;
#X connect 15 1 5 0;
#X connect 16 0 17 0;
#X coords 0 -1 1 1 200 70 1 10 10;
