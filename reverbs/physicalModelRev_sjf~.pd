#N canvas 15 -1302 1065 996 12;
#N canvas 0 25 624 566 reorderDimensions 0;
#X obj 222 70 pack 0 0;
#X obj 306 73 pack 0 1;
#X obj 396 70 pack 0 2;
#X obj 318 130 t b l;
#X obj 351 160 tabwrite \$0-dimensions;
#X obj 222 26 r \$0-Lsnd;
#X obj 306 26 r \$0-Wsnd;
#X obj 396 26 r \$0-Hsnd;
#X obj 84 206 t b b;
#X floatatom 166 288 5 0 0 0 - - - 0;
#X floatatom 21 288 5 0 0 0 - - - 0;
#X floatatom 209 288 5 0 0 0 - - - 0;
#X obj 99 336 == 0;
#X obj 145 336 == 1;
#X obj 184 336 == 2;
#X floatatom 328 291 5 0 0 0 - - - 0;
#X obj 261 339 == 0;
#X obj 307 339 == 1;
#X obj 346 339 == 2;
#X obj 149 382 +;
#X obj 198 382 +;
#X obj 248 382 +;
#X obj 149 406 sel 0;
#X obj 198 406 sel 0;
#X obj 248 406 sel 0;
#X obj 149 430 0;
#X obj 198 430 1;
#X obj 248 430 2;
#X obj 157 468 tabread \$0-dimensions;
#X obj 18 508 pack 0 0 0;
#X obj 21 254 array max \$0-dimensions;
#X obj 209 254 array min \$0-dimensions;
#X obj 18 532 outlet;
#X text 434 353 ensure dimensions are \; longest middle shortest;
#X connect 0 0 3 0;
#X connect 1 0 3 0;
#X connect 2 0 3 0;
#X connect 3 0 8 0;
#X connect 3 1 4 0;
#X connect 5 0 0 0;
#X connect 6 0 1 0;
#X connect 7 0 2 0;
#X connect 8 0 30 0;
#X connect 8 1 31 0;
#X connect 9 0 12 0;
#X connect 9 0 13 0;
#X connect 9 0 14 0;
#X connect 10 0 29 0;
#X connect 11 0 29 2;
#X connect 12 0 19 0;
#X connect 13 0 20 0;
#X connect 14 0 21 0;
#X connect 15 0 16 0;
#X connect 15 0 17 0;
#X connect 15 0 18 0;
#X connect 16 0 19 1;
#X connect 17 0 20 1;
#X connect 18 0 21 1;
#X connect 19 0 22 0;
#X connect 20 0 23 0;
#X connect 21 0 24 0;
#X connect 22 0 25 0;
#X connect 23 0 26 0;
#X connect 24 0 27 0;
#X connect 25 0 28 0;
#X connect 26 0 28 0;
#X connect 27 0 28 0;
#X connect 28 0 29 1;
#X connect 29 0 32 0;
#X connect 30 0 10 0;
#X connect 30 1 9 0;
#X connect 31 0 11 0;
#X connect 31 1 15 0;
#X restore 469 121 pd reorderDimensions;
#X obj 843 10 loadbang;
#X obj 844 64 \$0;
#X obj 913 11 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 53 486 clone physicalModel/pmDelayLine~_sjf 3 \$0 axial;
#N canvas 469 494 450 300 arrays 0;
#X obj 42 37 array define \$0-dimensions 3;
#X obj 42 67 array define \$0-axialDelays 3;
#X obj 42 127 array define \$0-obliqueDelays 1;
#X obj 42 97 array define \$0-tangentialDelays 4;
#X obj 42 157 array define \$0-roomtypeRatioX 7;
#X obj 42 187 array define \$0-roomtypeRatioY 7;
#X restore 471 63 pd arrays;
#X obj 469 145 t b l;
#N canvas 439 57 818 588 writeDelayTimes 0;
#X obj 37 37 inlet;
#X obj 36 123 physicalModel/roomModeCalculator_sjf, f 66;
#X obj 36 68 t l b, f 75;
#X obj 36 257 t f b;
#X obj 69 288 +;
#X obj 99 289 + 1;
#X obj 29 328 tabwrite \$0-axialDelays;
#X msg 555 126 0;
#X obj 220 298 t f b;
#X obj 253 329 +;
#X obj 283 330 + 1;
#X obj 463 310 t f b;
#X obj 496 341 +;
#X obj 526 342 + 1;
#X obj 213 369 tabwrite \$0-tangentialDelays;
#X obj 456 381 tabwrite \$0-obliqueDelays;
#X obj 36 164 expr 1000/$f1;
#X obj 219 164 expr 1000/$f1;
#X obj 403 164 expr 1000/$f1;
#X connect 0 0 2 0;
#X connect 1 0 16 0;
#X connect 1 1 17 0;
#X connect 1 2 18 0;
#X connect 2 0 1 0;
#X connect 2 1 7 0;
#X connect 3 0 6 0;
#X connect 3 1 4 0;
#X connect 4 0 5 0;
#X connect 4 0 6 1;
#X connect 5 0 4 1;
#X connect 7 0 4 1;
#X connect 7 0 9 1;
#X connect 7 0 12 1;
#X connect 8 0 14 0;
#X connect 8 1 9 0;
#X connect 9 0 10 0;
#X connect 9 0 14 1;
#X connect 10 0 9 1;
#X connect 11 0 15 0;
#X connect 11 1 12 0;
#X connect 12 0 13 0;
#X connect 12 0 15 1;
#X connect 13 0 12 1;
#X connect 16 0 3 0;
#X connect 17 0 8 0;
#X connect 18 0 11 0;
#X restore 503 175 pd writeDelayTimes;
#X obj 469 199 s \$0-dtChange;
#X obj 158 537 clone physicalModel/pmDelayLine~_sjf 4 \$0 tangential;
#X obj 168 590 clone physicalModel/pmDelayLine~_sjf 1 \$0 oblique;
#X obj 17 37 hsl 162 19 0 1 0 0 \$0-decay \$0-decay decay 10 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 17 56 hsl 162 19 0 1 0 0 \$0-damping \$0-damping damping 10 10 0 12 #fcfcfc #000000 #000000 0 1;
#N canvas 920 525 510 394 parameters 0;
#X floatatom 87 44 5 0 0 0 - - - 0;
#X obj 86 215 pack 0 5;
#X obj 86 239 line~;
#X floatatom 366 46 5 0 0 0 - - - 0;
#X obj 366 243 pack 0 5;
#X obj 366 267 line~;
#X obj 366 22 r \$0-damping;
#X obj 366 291 s~ \$0-dampingSig;
#X obj 87 67 min 1;
#X obj 366 69 min 1;
#X obj 366 93 max 0;
#X obj 87 91 max 0;
#X obj 86 166 * 9.5;
#X obj 86 190 + 0.5;
#X obj 366 187 * 0.6;
#X obj 87 20 r \$0-decay;
#X obj 86 263 s~ \$0-decaySig;
#X obj 366 211 + 0.399;
#X obj 366 117 sqrt;
#X floatatom 87 139 5 0 0 0 - - - 0;
#X obj 87 115 expr pow($f1 \, 2);
#X connect 0 0 8 0;
#X connect 1 0 2 0;
#X connect 2 0 16 0;
#X connect 3 0 9 0;
#X connect 4 0 5 0;
#X connect 5 0 7 0;
#X connect 6 0 3 0;
#X connect 8 0 11 0;
#X connect 9 0 10 0;
#X connect 10 0 18 0;
#X connect 11 0 20 0;
#X connect 12 0 13 0;
#X connect 13 0 1 0;
#X connect 14 0 17 0;
#X connect 15 0 0 0;
#X connect 17 0 4 0;
#X connect 18 0 14 0;
#X connect 19 0 12 0;
#X connect 20 0 19 0;
#X restore 472 35 pd parameters;
#X obj 749 16 r \$0-dsp;
#X obj 749 49 switch~;
#X obj 187 232 tgl 19 0 \$0-dsp \$0-dsp on 2 10 0 10 #fcfcfc #000000 #000000 0 1;
#X obj 319 446 r~ \$0-decaySig;
#X obj 470 504 r~ \$0-decaySig;
#X obj 484 563 r~ \$0-decaySig;
#X obj 222 419 r~ \$0-dampingSig;
#X obj 324 510 r~ \$0-dampingSig;
#X obj 334 560 r~ \$0-dampingSig;
#X obj 26 316 inlet~;
#X obj 45 810 outlet~;
#X obj 189 814 outlet~;
#X obj 84 613 +~;
#X obj 109 591 +~;
#X floatatom 60 79 9 0 0 0 Volume \$0-Vrec \$0-Vsnd 0;
#X obj 14 115 hradio 20 1 0 8 \$0-Rsnd \$0-Rrec room\ type 0 -10 0 12 #fcfcfc #000000 #000000 0;
#X obj 843 34 t b b, f 18;
#X obj 65 395 +~;
#N canvas 72 166 783 300 diffusion 0;
#X obj 89 21 inlet~;
#X obj 89 211 outlet~;
#X obj 406 56 r~ \$0-dampingSig;
#X obj 89 59 ../filters/allpass2_sjf~ 12.06 -0.5;
#X obj 89 97 ../filters/allpass2_sjf~ 10 -0.5;
#X obj 89 135 ../filters/allpass2_sjf~ 7.73243 -0.5;
#X obj 89 173 ../filters/allpass2_sjf~ 5.10204 -0.5;
#X connect 0 0 3 0;
#X connect 2 0 3 3;
#X connect 2 0 4 3;
#X connect 2 0 5 3;
#X connect 2 0 6 3;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 1 0;
#X restore 26 348 pd diffusion;
#X obj 17 232 hsl 162 19 0 1 0 0 \$0-ersnd \$0-errec early\ reflections 5 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 145 337 pack 0 5;
#X obj 145 361 line~;
#X obj 17 503 *~;
#X text 126 78 m3;
#N canvas 0 25 613 541 roomCalculations 0;
#X floatatom 23 18 5 0.25 100 0 L \$0-Lrec \$0-Lsnd 0;
#X floatatom 73 18 5 0.25 100 0 W \$0-Wrec \$0-Wsnd 0;
#X floatatom 124 18 5 0.25 100 0 H \$0-Hrec \$0-Hsnd 0;
#X obj 265 36 r \$0-Vsnd;
#X floatatom 265 60 5 0 0 0 - - - 0;
#X obj 265 83 t f b;
#X obj 265 136 /;
#X obj 305 158 *;
#X floatatom 198 337 5 0 0 0 - - - 0;
#X floatatom 196 107 5 0 0 0 - - - 0;
#X obj 255 195 t f b;
#X obj 283 225 1;
#X obj 283 249 / 3;
#X floatatom 283 273 5 0 0 0 - - - 0;
#X floatatom 265 160 5 0 0 0 - - - 0;
#X obj 198 313 expr pow($f1 \, $f2);
#X obj 368 28 r \$0-Rsnd;
#X obj 327 98 t b b, f 10;
#X obj 198 360 t f f f, f 16;
#X obj 310 392 s \$0-Hrec;
#X obj 244 387 t f b;
#X obj 244 455 *;
#X obj 244 480 s \$0-Wrec;
#X obj 110 406 t f b;
#X obj 110 474 *;
#X obj 110 499 s \$0-Lrec;
#X obj 420 80 value \$0-room;
#N canvas 208 233 450 300 roomX 0;
#X obj 46 84 tabread \$0-roomtypeRatioX;
#X obj 46 60 value \$0-room;
#X obj 46 31 inlet;
#X obj 46 108 outlet;
#X connect 0 0 3 0;
#X connect 1 0 0 0;
#X connect 2 0 1 0;
#X restore 305 125 pd roomX;
#N canvas 208 233 450 300 roomY 0;
#X obj 46 60 value \$0-room;
#X obj 46 31 inlet;
#X obj 46 108 outlet;
#X obj 46 84 tabread \$0-roomtypeRatioY;
#X connect 0 0 3 0;
#X connect 1 0 0 0;
#X connect 3 0 2 0;
#X restore 372 126 pd roomY;
#N canvas 208 233 450 300 roomX 0;
#X obj 46 84 tabread \$0-roomtypeRatioX;
#X obj 46 60 value \$0-room;
#X obj 46 31 inlet;
#X obj 46 108 outlet;
#X connect 0 0 3 0;
#X connect 1 0 0 0;
#X connect 2 0 1 0;
#X restore 139 432 pd roomX;
#N canvas 208 233 450 300 roomY 0;
#X obj 46 60 value \$0-room;
#X obj 46 31 inlet;
#X obj 46 108 outlet;
#X obj 46 84 tabread \$0-roomtypeRatioY;
#X connect 0 0 3 0;
#X connect 1 0 0 0;
#X connect 3 0 2 0;
#X restore 261 421 pd roomY;
#X obj 368 52 t b f;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 5 0 9 0;
#X connect 5 1 17 0;
#X connect 6 0 10 0;
#X connect 6 0 14 0;
#X connect 7 0 6 1;
#X connect 8 0 18 0;
#X connect 10 0 15 0;
#X connect 10 1 11 0;
#X connect 11 0 12 0;
#X connect 12 0 13 0;
#X connect 13 0 15 1;
#X connect 15 0 8 0;
#X connect 16 0 31 0;
#X connect 17 0 27 0;
#X connect 17 1 28 0;
#X connect 18 0 23 0;
#X connect 18 1 20 0;
#X connect 18 2 19 0;
#X connect 20 0 21 0;
#X connect 20 1 30 0;
#X connect 21 0 22 0;
#X connect 23 0 24 0;
#X connect 23 1 29 0;
#X connect 24 0 25 0;
#X connect 27 0 7 0;
#X connect 28 0 7 1;
#X connect 29 0 24 1;
#X connect 30 0 21 1;
#X connect 31 0 4 0;
#X connect 31 1 26 0;
#X coords 0 -1 1 1 160 30 2 10 10;
#X restore 14 135 pd roomCalculations;
#N canvas 353 378 504 300 roomRatios 0;
#X obj 85 54 t b b;
#X obj 19 129 array set \$0-roomtypeRatioX;
#X obj 253 108 array set \$0-roomtypeRatioY;
#X msg 19 85 1.39 1.59 1.54 1.9 1.9 2.5 2.33;
#X msg 253 84 1.14 1.26 1.28 1.3 1.4 1.5 1.6;
#X obj 85 26 inlet;
#X text 31 166 ratios from here \; https://radiobombfm.wordpress.com/2012/09/15/sound-101-the-golden-acoustic-ratio/;
#X connect 0 0 3 0;
#X connect 0 1 4 0;
#X connect 3 0 1 0;
#X connect 4 0 2 0;
#X connect 5 0 0 0;
#X restore 924 61 pd roomRatios;
#X obj 14 189 tgl 19 0 \$0-tangentialOnsnd \$0-tangentialOnrec tangential\ modes 20 10 0 8 #fcfcfc #000000 #000000 0 1;
#X obj 14 208 tgl 19 0 \$0-obliqueOnsnd \$0-obliqueOnrec oblique\ modes 20 10 0 8 #fcfcfc #000000 #000000 0 1;
#X obj 14 170 tgl 19 0 \$0-axialOnsnd \$0-axialOnrec axial\ modes 20 10 0 8 #fcfcfc #000000 #000000 0 1;
#N canvas 817 184 450 300 decorrelation 0;
#X obj 37 37 inlet~;
#X obj 18 168 outlet~;
#X obj 72 122 outlet~;
#X obj 72 98 ../filters/allpass_sjf~ 1.48 0.7;
#X obj 18 144 ../filters/allpass_sjf~ 4.52 0.7;
#X connect 0 0 3 0;
#X connect 0 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 1 0;
#X restore 84 637 pd decorrelation;
#X text 525 277 This example is based on a variety of ideas \; Starting with this video by perry cook \; https://www.youtube.com/watch?v=yluC4CyKHqs&ab_channel=Kadenze \; \; We calculate our delay lengths based on room modes... \; I've added da diffusion stage to thiken things up and also added a variety pof room types based on "ideal ratios" for Length Width and Height;
#X obj 145 313 r \$0-ersnd;
#X msg 844 88 \; \$1-axialOnrec 1 \; \$1-Rrec 0 \; \$1-Vrec 2000 \; \$1-decay 0.1 \; \$1-damping 0.2 \; \$1-errec 0.4 \; \$1-dsp 0;
#X connect 0 0 6 0;
#X connect 1 0 30 0;
#X connect 2 0 46 0;
#X connect 3 0 30 0;
#X connect 4 0 26 0;
#X connect 6 0 8 0;
#X connect 6 1 7 0;
#X connect 9 0 27 0;
#X connect 10 0 27 1;
#X connect 14 0 15 0;
#X connect 17 0 4 2;
#X connect 18 0 9 2;
#X connect 19 0 10 2;
#X connect 20 0 4 1;
#X connect 21 0 9 1;
#X connect 22 0 10 1;
#X connect 23 0 32 0;
#X connect 26 0 43 0;
#X connect 27 0 26 1;
#X connect 30 0 2 0;
#X connect 30 1 39 0;
#X connect 31 0 4 0;
#X connect 31 0 9 0;
#X connect 31 0 10 0;
#X connect 32 0 31 0;
#X connect 32 0 36 0;
#X connect 34 0 35 0;
#X connect 35 0 36 1;
#X connect 36 0 26 0;
#X connect 43 0 24 0;
#X connect 43 1 25 0;
#X connect 45 0 34 0;
#X coords 0 -1 1 1 200 250 1 10 10;
