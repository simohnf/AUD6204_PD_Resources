#N canvas 71 25 1065 847 12;
#N canvas 0 25 624 566 reorderDimensions 0;
#X obj 222 70 pack 0 0;
#X obj 306 73 pack 0 1;
#X obj 396 70 pack 0 2;
#X obj 318 130 t b l;
#X obj 351 160 tabwrite \$0-dimensions;
#X obj 222 26 r \$0-Lsnd;
#X obj 306 26 r \$0-Wsnd;
#X obj 396 26 r \$0-Hsnd;
#X obj 84 206 t b b;
#X floatatom 166 288 5 0 0 0 - - - 0;
#X floatatom 21 288 5 0 0 0 - - - 0;
#X floatatom 209 288 5 0 0 0 - - - 0;
#X obj 99 336 == 0;
#X obj 145 336 == 1;
#X obj 184 336 == 2;
#X floatatom 328 291 5 0 0 0 - - - 0;
#X obj 261 339 == 0;
#X obj 307 339 == 1;
#X obj 346 339 == 2;
#X obj 149 382 +;
#X obj 198 382 +;
#X obj 248 382 +;
#X obj 149 406 sel 0;
#X obj 198 406 sel 0;
#X obj 248 406 sel 0;
#X obj 149 430 0;
#X obj 198 430 1;
#X obj 248 430 2;
#X obj 157 468 tabread \$0-dimensions;
#X obj 18 508 pack 0 0 0;
#X obj 21 254 array max \$0-dimensions;
#X obj 209 254 array min \$0-dimensions;
#X obj 18 532 outlet;
#X text 434 353 ensure dimensions are \; longest middle shortest;
#X connect 0 0 3 0;
#X connect 1 0 3 0;
#X connect 2 0 3 0;
#X connect 3 0 8 0;
#X connect 3 1 4 0;
#X connect 5 0 0 0;
#X connect 6 0 1 0;
#X connect 7 0 2 0;
#X connect 8 0 30 0;
#X connect 8 1 31 0;
#X connect 9 0 12 0;
#X connect 9 0 13 0;
#X connect 9 0 14 0;
#X connect 10 0 29 0;
#X connect 11 0 29 2;
#X connect 12 0 19 0;
#X connect 13 0 20 0;
#X connect 14 0 21 0;
#X connect 15 0 16 0;
#X connect 15 0 17 0;
#X connect 15 0 18 0;
#X connect 16 0 19 1;
#X connect 17 0 20 1;
#X connect 18 0 21 1;
#X connect 19 0 22 0;
#X connect 20 0 23 0;
#X connect 21 0 24 0;
#X connect 22 0 25 0;
#X connect 23 0 26 0;
#X connect 24 0 27 0;
#X connect 25 0 28 0;
#X connect 26 0 28 0;
#X connect 27 0 28 0;
#X connect 28 0 29 1;
#X connect 29 0 32 0;
#X connect 30 0 10 0;
#X connect 30 1 9 0;
#X connect 31 0 11 0;
#X connect 31 1 15 0;
#X restore 469 121 pd reorderDimensions;
#X obj 843 10 loadbang;
#X obj 843 64 \$0;
#X obj 913 11 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#N canvas 469 494 450 300 arrays 0;
#X obj 42 37 array define \$0-dimensions 3;
#X obj 42 67 array define \$0-axialDelays 3;
#X obj 42 127 array define \$0-obliqueDelays 1;
#X obj 42 97 array define \$0-tangentialDelays 4;
#X obj 42 157 array define \$0-roomtypeRatioX 7;
#X obj 42 187 array define \$0-roomtypeRatioY 7;
#X restore 471 63 pd arrays;
#X obj 469 145 t b l;
#N canvas 439 57 818 588 writeDelayTimes 0;
#X obj 37 37 inlet;
#X obj 36 123 physicalModel/roomModeCalculator_sjf, f 66;
#X obj 36 68 t l b, f 75;
#X obj 36 257 t f b;
#X obj 69 288 +;
#X obj 99 289 + 1;
#X obj 29 328 tabwrite \$0-axialDelays;
#X msg 555 126 0;
#X obj 220 298 t f b;
#X obj 253 329 +;
#X obj 283 330 + 1;
#X obj 463 310 t f b;
#X obj 496 341 +;
#X obj 526 342 + 1;
#X obj 213 369 tabwrite \$0-tangentialDelays;
#X obj 456 381 tabwrite \$0-obliqueDelays;
#X obj 36 164 expr 1000/$f1;
#X obj 219 164 expr 1000/$f1;
#X obj 403 164 expr 1000/$f1;
#X connect 0 0 2 0;
#X connect 1 0 16 0;
#X connect 1 1 17 0;
#X connect 1 2 18 0;
#X connect 2 0 1 0;
#X connect 2 1 7 0;
#X connect 3 0 6 0;
#X connect 3 1 4 0;
#X connect 4 0 5 0;
#X connect 4 0 6 1;
#X connect 5 0 4 1;
#X connect 7 0 4 1;
#X connect 7 0 9 1;
#X connect 7 0 12 1;
#X connect 8 0 14 0;
#X connect 8 1 9 0;
#X connect 9 0 10 0;
#X connect 9 0 14 1;
#X connect 10 0 9 1;
#X connect 11 0 15 0;
#X connect 11 1 12 0;
#X connect 12 0 13 0;
#X connect 12 0 15 1;
#X connect 13 0 12 1;
#X connect 16 0 3 0;
#X connect 17 0 8 0;
#X connect 18 0 11 0;
#X restore 503 175 pd writeDelayTimes;
#X obj 469 199 s \$0-dtChange;
#X obj 17 37 hsl 162 19 0 1 0 0 \$0-decay \$0-decay decay 10 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 17 56 hsl 162 19 0 1 0 0 \$0-damping \$0-damping damping 10 10 0 12 #fcfcfc #000000 #000000 0 1;
#N canvas 920 478 510 394 parameters 0;
#X floatatom 87 44 5 0 0 0 - - - 0;
#X obj 86 215 pack 0 5;
#X obj 86 239 line~;
#X floatatom 366 46 5 0 0 0 - - - 0;
#X obj 366 243 pack 0 5;
#X obj 366 267 line~;
#X obj 366 22 r \$0-damping;
#X obj 366 291 s~ \$0-dampingSig;
#X obj 87 67 min 1;
#X obj 366 69 min 1;
#X obj 366 93 max 0;
#X obj 87 91 max 0;
#X obj 86 166 * 9.5;
#X obj 86 190 + 0.5;
#X obj 366 187 * 0.6;
#X obj 87 20 r \$0-decay;
#X obj 86 263 s~ \$0-decaySig;
#X obj 366 117 sqrt;
#X floatatom 87 139 5 0 0 0 - - - 0;
#X obj 87 115 expr pow($f1 \, 2);
#X obj 366 211 + 0.39;
#X connect 0 0 8 0;
#X connect 1 0 2 0;
#X connect 2 0 16 0;
#X connect 3 0 9 0;
#X connect 4 0 5 0;
#X connect 5 0 7 0;
#X connect 6 0 3 0;
#X connect 8 0 11 0;
#X connect 9 0 10 0;
#X connect 10 0 17 0;
#X connect 11 0 19 0;
#X connect 12 0 13 0;
#X connect 13 0 1 0;
#X connect 14 0 20 0;
#X connect 15 0 0 0;
#X connect 17 0 14 0;
#X connect 18 0 12 0;
#X connect 19 0 18 0;
#X connect 20 0 4 0;
#X restore 472 35 pd parameters;
#X obj 749 16 r \$0-dsp;
#X obj 749 49 switch~;
#X obj 187 232 tgl 19 0 \$0-dsp \$0-dsp on 2 10 0 10 #fcfcfc #000000 #000000 0 1;
#X obj 129 268 inlet~;
#X obj 45 810 outlet~;
#X obj 189 814 outlet~;
#X floatatom 121 79 9 0 0 0 Volume\ of\ Room \$0-Vrec \$0-Vsnd 0;
#X obj 14 115 hradio 20 1 0 8 \$0-Rsnd \$0-Rrec room\ type 0 -10 0 12 #fcfcfc #000000 #000000 0;
#X obj 843 38 t b b, f 12;
#X obj 17 232 hsl 162 19 0 1 0 0 \$0-ersnd \$0-errec early\ reflections 5 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 70 547 pack 0 5;
#X obj 70 571 line~;
#X obj 17 577 *~;
#X text 187 78 m3;
#N canvas 0 25 613 541 roomCalculations 0;
#X floatatom 23 18 5 0.25 100 0 L \$0-Lrec \$0-Lsnd 0;
#X floatatom 73 18 5 0.25 100 0 W \$0-Wrec \$0-Wsnd 0;
#X floatatom 124 18 5 0.25 100 0 H \$0-Hrec \$0-Hsnd 0;
#X obj 265 36 r \$0-Vsnd;
#X floatatom 265 60 5 0 0 0 - - - 0;
#X obj 265 83 t f b;
#X obj 265 136 /;
#X obj 305 158 *;
#X floatatom 198 337 5 0 0 0 - - - 0;
#X floatatom 196 107 5 0 0 0 - - - 0;
#X obj 255 195 t f b;
#X obj 283 225 1;
#X obj 283 249 / 3;
#X floatatom 283 273 5 0 0 0 - - - 0;
#X floatatom 265 160 5 0 0 0 - - - 0;
#X obj 198 313 expr pow($f1 \, $f2);
#X obj 368 28 r \$0-Rsnd;
#X obj 327 98 t b b, f 10;
#X obj 198 360 t f f f, f 16;
#X obj 310 392 s \$0-Hrec;
#X obj 244 387 t f b;
#X obj 244 455 *;
#X obj 244 480 s \$0-Wrec;
#X obj 110 406 t f b;
#X obj 110 474 *;
#X obj 110 499 s \$0-Lrec;
#X obj 420 80 value \$0-room;
#N canvas 208 233 450 300 roomX 0;
#X obj 46 84 tabread \$0-roomtypeRatioX;
#X obj 46 60 value \$0-room;
#X obj 46 31 inlet;
#X obj 46 108 outlet;
#X connect 0 0 3 0;
#X connect 1 0 0 0;
#X connect 2 0 1 0;
#X restore 305 125 pd roomX;
#N canvas 208 233 450 300 roomY 0;
#X obj 46 60 value \$0-room;
#X obj 46 31 inlet;
#X obj 46 108 outlet;
#X obj 46 84 tabread \$0-roomtypeRatioY;
#X connect 0 0 3 0;
#X connect 1 0 0 0;
#X connect 3 0 2 0;
#X restore 372 126 pd roomY;
#N canvas 208 233 450 300 roomX 0;
#X obj 46 84 tabread \$0-roomtypeRatioX;
#X obj 46 60 value \$0-room;
#X obj 46 31 inlet;
#X obj 46 108 outlet;
#X connect 0 0 3 0;
#X connect 1 0 0 0;
#X connect 2 0 1 0;
#X restore 139 432 pd roomX;
#N canvas 208 233 450 300 roomY 0;
#X obj 46 60 value \$0-room;
#X obj 46 31 inlet;
#X obj 46 108 outlet;
#X obj 46 84 tabread \$0-roomtypeRatioY;
#X connect 0 0 3 0;
#X connect 1 0 0 0;
#X connect 3 0 2 0;
#X restore 261 421 pd roomY;
#X obj 368 52 t b f;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 5 0 9 0;
#X connect 5 1 17 0;
#X connect 6 0 10 0;
#X connect 6 0 14 0;
#X connect 7 0 6 1;
#X connect 8 0 18 0;
#X connect 10 0 15 0;
#X connect 10 1 11 0;
#X connect 11 0 12 0;
#X connect 12 0 13 0;
#X connect 13 0 15 1;
#X connect 15 0 8 0;
#X connect 16 0 31 0;
#X connect 17 0 27 0;
#X connect 17 1 28 0;
#X connect 18 0 23 0;
#X connect 18 1 20 0;
#X connect 18 2 19 0;
#X connect 20 0 21 0;
#X connect 20 1 30 0;
#X connect 21 0 22 0;
#X connect 23 0 24 0;
#X connect 23 1 29 0;
#X connect 24 0 25 0;
#X connect 27 0 7 0;
#X connect 28 0 7 1;
#X connect 29 0 24 1;
#X connect 30 0 21 1;
#X connect 31 0 4 0;
#X connect 31 1 26 0;
#X coords 0 -1 1 1 160 30 2 10 10;
#X restore 14 135 pd roomCalculations;
#N canvas 353 378 504 300 roomRatios 0;
#X obj 85 54 t b b;
#X obj 19 129 array set \$0-roomtypeRatioX;
#X obj 253 108 array set \$0-roomtypeRatioY;
#X msg 19 85 1.39 1.59 1.54 1.9 1.9 2.5 2.33;
#X msg 253 84 1.14 1.26 1.28 1.3 1.4 1.5 1.6;
#X obj 85 26 inlet;
#X text 31 166 ratios from here \; https://radiobombfm.wordpress.com/2012/09/15/sound-101-the-golden-acoustic-ratio/;
#X connect 0 0 3 0;
#X connect 0 1 4 0;
#X connect 3 0 1 0;
#X connect 4 0 2 0;
#X connect 5 0 0 0;
#X restore 924 64 pd roomRatios;
#X obj 14 189 tgl 19 0 \$0-tangentialOnsnd \$0-tangentialOnrec tangential\ modes 20 10 0 8 #fcfcfc #000000 #000000 0 1;
#X obj 14 208 tgl 19 0 \$0-obliqueOnsnd \$0-obliqueOnrec oblique\ modes 20 10 0 8 #fcfcfc #000000 #000000 0 1;
#X obj 14 170 tgl 19 0 \$0-axialOnsnd \$0-axialOnrec axial\ modes 20 10 0 8 #fcfcfc #000000 #000000 0 1;
#N canvas 817 184 450 300 decorrelation 0;
#X obj 37 37 inlet~;
#X obj 18 168 outlet~;
#X obj 72 122 outlet~;
#X obj 72 98 ../filters/allpass_sjf~ 1.48 0.7;
#X obj 18 144 ../filters/allpass_sjf~ 4.52 0.7;
#X connect 0 0 3 0;
#X connect 0 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 1 0;
#X restore 84 637 pd decorrelation;
#X obj 70 523 r \$0-ersnd;
#X msg 843 88 \; \$1-axialOnrec 1 \; \$1-Rrec 0 \; \$1-Vrec 2000 \; \$1-decay 0.1 \; \$1-damping 0.2 \; \$1-errec 0.4 \; \$1-dsp 0, f 17;
#N canvas 0 25 1009 378 late 0;
#X obj 103 150 clone physicalModel/pmDelayLine~_sjf 3 \$0 axial, f 30;
#X obj 358 150 clone physicalModel/pmDelayLine~_sjf 4 \$0 tangential, f 30;
#X obj 582 150 clone physicalModel/pmDelayLine~_sjf 1 \$0 oblique, f 30;
#X obj 475 38 r~ \$0-decaySig;
#X obj 304 41 r~ \$0-dampingSig;
#X obj 67 73 inlet~;
#X obj 415 302 outlet~;
#X text 677 21 3 delaylines for primary axial modes \; 4 delaylines for the lowest tangential modes \; 1 for the lowest oblique mode;
#X connect 0 0 6 0;
#X connect 1 0 6 0;
#X connect 2 0 6 0;
#X connect 3 0 0 2;
#X connect 3 0 2 2;
#X connect 3 0 1 2;
#X connect 4 0 0 1;
#X connect 4 0 2 1;
#X connect 4 0 1 1;
#X connect 5 0 0 0;
#X connect 5 0 2 0;
#X connect 5 0 1 0;
#X restore 162 583 pd late;
#X text 546 471 This example is based on a variety of ideas \; Starting with this video by perry cook \; https://www.youtube.com/watch?v=yluC4CyKHqs&ab_channel=Kadenze \; \; We calculate our main delay lengths based on room modes... \; I've added a diffusion stage to thicken things up and also added a variety of room types based on "ideal ratios" for Length Width and Height;
#X obj 294 405 hsl 162 19 0 1 0 0 \$0-er2latesnd \$0-er2laterec early-->late 5 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 165 521 *~;
#X obj 292 483 pack 0 5;
#X obj 292 507 line~;
#X obj 291 429 sqrt;
#X obj 373 429 expr sqrt(1-$f1);
#X floatatom 373 453 5 0 0 0 - - - 0;
#X floatatom 291 453 5 0 0 0 - - - 0;
#X obj 376 484 pack 0 5;
#X obj 376 508 line~;
#X obj 264 549 *~;
#X obj 262 130 hradio 19 1 0 8 \$0-ertypesnd \$0-ertyperec er\ type 0 -10 0 12 #fcfcfc #000000 #000000 0;
#N canvas 409 284 450 300 early 0;
#X obj 24 120 inlet~;
#N canvas 240 25 783 300 diffusion_ap 0;
#X obj 89 21 inlet~;
#X obj 89 211 outlet~;
#X obj 89 59 ../filters/allpass2_sjf~ 12.06 -0.5;
#X obj 89 97 ../filters/allpass2_sjf~ 10 -0.5;
#X obj 89 135 ../filters/allpass2_sjf~ 7.73243 -0.5;
#X obj 89 173 ../filters/allpass2_sjf~ 5.10204 -0.5;
#X text 344 242 We need around 1000 echos per second to avoid flutter;
#X obj 586 37 inlet;
#X obj 586 61 switch~;
#X obj 372 38 inlet~;
#X connect 0 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 1 0;
#X connect 7 0 8 0;
#X connect 9 0 2 3;
#X connect 9 0 3 3;
#X connect 9 0 4 3;
#X connect 9 0 5 3;
#X restore 9 222 pd diffusion_ap;
#N canvas 149 25 826 363 diffusion_mt 0;
#X obj 140 39 inlet~;
#X obj 42 313 outlet~;
#X obj 140 81 delwrite~ \$0-multiTapEarly 1000;
#X floatatom 42 60 5 0 0 0 - - - 0;
#X msg 42 83 vis \$1 1;
#X obj 584 142 switch~;
#X obj 452 57 inlet~;
#X text 452 38 damping;
#X obj 42 253 fexpr~ $x1[0] + $x2[0] * ( $y1[-1] - $x1[0] ), f 59;
#X text 349 272 onepole low pass filter;
#X obj 621 78 inlet;
#X obj 42 216 *~;
#X obj 621 102 tgl 19 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#N canvas 179 204 450 300 calculateScalingFactor 0;
#X floatatom 51 82 5 0 0 0 - - - 0;
#X obj 51 58 expr log10($f1)/log10(2);
#X obj 51 105 expr 1 / (pow(2 \, $f1/2));
#X floatatom 51 129 11 0 0 0 - - - 0;
#X obj 51 34 r \$0-nErMTVoices;
#X obj 51 152 outlet;
#X connect 0 0 2 0;
#X connect 1 0 0 0;
#X connect 2 0 3 0;
#X connect 3 0 5 0;
#X connect 4 0 1 0;
#X restore 92 174 pd calculateScalingFactor;
#X text 344 302 We need more than 1000 echos per second to avoid flutter!!!;
#N canvas 208 233 462 282 delayTimes 0;
#X obj 38 13 r \$0-dtChange;
#X obj 41 200 s \$0-erDelayTimesChange;
#X obj 38 37 t b b f, f 29;
#N canvas 121 146 450 353 calculateNewBlockSize 0;
#X obj 37 37 inlet;
#X msg 38 59 0;
#X obj 37 122 * 44.1;
#X obj 37 146 int;
#X obj 37 170 + 1;
#X floatatom 37 194 5 0 0 0 - - - 0;
#X floatatom 37 243 5 0 0 0 - - - 0;
#X text 85 243 new block size;
#X obj 37 217 expr if($f1>=64 \, 64 \, pow(2 \, int(log10($f1)/log10(2))));
#X msg 37 275 set \$1 1 1;
#X obj 37 299 outlet;
#X obj 37 93 tabread \$0-erMTDelayTimes;
#X connect 0 0 1 0;
#X connect 1 0 11 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 8 0;
#X connect 6 0 9 0;
#X connect 8 0 6 0;
#X connect 9 0 10 0;
#X connect 11 0 2 0;
#X restore 140 142 pd calculateNewBlockSize;
#N canvas 150 175 450 300 calculateERMTDelayTimes 0;
#N canvas 99 25 891 794 arrangeEarlyReflectionDelayTimes 0;
#X floatatom 439 162 5 0 0 0 - - - 0;
#X obj 439 90 r \$0-ermtvoiceNum;
#X obj 439 188 + 1;
#X obj 113 687 physicalModel/earlyReflectionsPrimeDelayTimesCalculator;
#X obj 49 90 array min \$0-axialDelays;
#X floatatom 49 114 5 0 0 0 - - - 0;
#X obj 49 324 / 1;
#X floatatom 49 398 5 0 0 0 - - - 0;
#X floatatom 109 351 5 0 0 0 - - - 0;
#X obj 67 279 t b f f f;
#X obj 85 461 int;
#X obj 85 485 ../uzi_sjf;
#X obj 142 544 *;
#X obj 49 421 t b f b, f 37;
#X obj 142 568 +;
#X obj 147 515 t f f;
#X obj 439 138 int;
#X obj 439 114 max;
#X obj 49 207 change;
#X obj 198 542 expr $f2*($f3-$f1)/$f3;
#X obj 142 592 t f f;
#X obj 113 711 outlet;
#X obj 49 22 inlet;
#X obj 231 91 array max \$0-axialDelays;
#X floatatom 231 115 5 0 0 0 - - - 0;
#X obj 49 46 t b b, f 26;
#X obj 49 137 +;
#X obj 49 161 / 2;
#X floatatom 49 185 5 0 0 0 - - - 0;
#X obj 439 212 s \$0-nErMTVoices;
#X obj 160 318 array size \$0-erMTDelayTimes;
#X text 120 184 median axial delay in ms;
#X connect 0 0 2 0;
#X connect 1 0 17 0;
#X connect 2 0 9 0;
#X connect 2 0 29 0;
#X connect 3 0 21 0;
#X connect 4 0 5 0;
#X connect 5 0 26 0;
#X connect 6 0 7 0;
#X connect 7 0 13 0;
#X connect 8 0 10 1;
#X connect 8 0 19 2;
#X connect 9 0 6 0;
#X connect 9 1 6 1;
#X connect 9 2 8 0;
#X connect 9 3 30 0;
#X connect 10 0 11 0;
#X connect 11 2 15 0;
#X connect 12 0 14 0;
#X connect 13 0 10 0;
#X connect 13 1 12 1;
#X connect 13 1 19 1;
#X connect 13 2 3 1;
#X connect 14 0 20 0;
#X connect 15 0 12 0;
#X connect 15 1 19 0;
#X connect 16 0 0 0;
#X connect 16 0 17 1;
#X connect 17 0 16 0;
#X connect 18 0 6 0;
#X connect 19 0 14 1;
#X connect 20 0 3 0;
#X connect 22 0 25 0;
#X connect 23 0 24 0;
#X connect 24 0 26 1;
#X connect 25 0 4 0;
#X connect 25 1 23 0;
#X connect 26 0 27 0;
#X connect 27 0 28 0;
#X connect 28 0 18 0;
#X restore 94 112 pd arrangeEarlyReflectionDelayTimes;
#X obj 94 136 t f b;
#X obj 128 161 +;
#X obj 161 162 + 1;
#X msg 125 76 0;
#X obj 95 21 inlet;
#X obj 75 217 tabwrite \$0-erMTDelayTimes;
#X obj 94 52 t b b;
#X connect 0 0 1 0;
#X connect 1 0 6 0;
#X connect 1 1 2 0;
#X connect 2 0 3 0;
#X connect 2 0 6 1;
#X connect 3 0 2 1;
#X connect 4 0 2 1;
#X connect 5 0 7 0;
#X connect 7 0 0 0;
#X connect 7 1 4 0;
#X restore 250 82 pd calculateERMTDelayTimes;
#X obj 140 166 outlet;
#X connect 0 0 2 0;
#X connect 2 0 1 0;
#X connect 2 1 3 0;
#X connect 2 2 4 0;
#X connect 3 0 5 0;
#X restore 507 85 pd delayTimes;
#X msg 541 175 64 1 1;
#X floatatom 92 198 5 0 0 0 - - - 0;
#X text 145 17 signal;
#X obj 540 216 array define \$0-erMTDelayTimes 32;
#X obj 42 118 clone physicalModel/earlyReflectionsmultitap_sjf~ 64 \$0 multiTapEarly erMTDelayTimes;
#X connect 0 0 2 0;
#X connect 3 0 4 0;
#X connect 4 0 20 0;
#X connect 6 0 8 1;
#X connect 8 0 1 0;
#X connect 10 0 5 0;
#X connect 10 0 12 0;
#X connect 11 0 8 0;
#X connect 13 0 11 1;
#X connect 13 0 17 0;
#X connect 15 0 5 0;
#X connect 15 0 16 0;
#X connect 20 0 11 0;
#X restore 139 222 pd diffusion_mt;
#X obj 201 142 r~ \$0-dampingSig;
#X obj 243 80 == 0;
#X obj 282 80 == 1;
#X obj 322 82 == 2;
#N canvas 609 71 807 732 diffusion_gl 0;
#X obj 41 5 inlet~;
#X obj 41 29 *~ 0.353553;
#X obj 347 45 inlet~;
#X text 347 26 damping;
#X obj 127 448 fexpr~ $x1[0] + $x2[0] * ( $y1[-1] - $x1[0] ), f 31;
#X obj 127 496 outlet~;
#X obj 603 69 loadbang;
#X obj 421 46 inlet;
#X obj 421 70 tgl 19 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 421 94 switch~;
#X obj 603 93 t b b;
#X obj 529 142 4;
#X obj 655 142 8;
#X obj 529 166 value \$0-glstages;
#X obj 655 166 value \$0-glchannels;
#X obj 588 206 *;
#X floatatom 588 230 5 0 0 0 - - - 0;
#X obj 567 332 array define \$0-glDel0 8;
#X obj 567 358 array define \$0-glDel1 8;
#X obj 567 384 array define \$0-glDel2 8;
#X obj 567 410 array define \$0-glDel3 8;
#N canvas 208 233 462 282 gldelayTimes 0;
#X obj 38 13 r \$0-dtChange;
#X obj 41 200 s \$0-glDTChange;
#N canvas 150 175 450 300 calculateERglDelayTimes 0;
#N canvas 99 25 891 794 arrangeEarlyReflectionDelayTimes 0;
#X obj 337 688 physicalModel/earlyReflectionsPrimeDelayTimesCalculator;
#X floatatom 273 469 5 0 0 0 - - - 0;
#X floatatom 471 427 5 0 0 0 - - - 0;
#X obj 309 532 int;
#X obj 309 556 ../uzi_sjf;
#X obj 366 615 *;
#X obj 273 492 t b f b, f 37;
#X obj 366 639 +;
#X obj 371 586 t f f;
#X obj 422 613 expr $f2*($f3-$f1)/$f3;
#X obj 366 663 t f f;
#X obj 337 712 outlet;
#X obj 273 23 inlet;
#X obj 273 74 array max \$0-axialDelays;
#X floatatom 273 98 5 0 0 0 - - - 0;
#X obj 334 24 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 273 47 t b;
#X obj 273 145 t f b, f 29;
#X obj 489 146 value \$0-glstages;
#X obj 489 170 expr pow(2 \, $f1)-1;
#X floatatom 489 194 5 0 0 0 - - - 0;
#X obj 273 169 /;
#X floatatom 273 193 5 0 0 0 - - - 0;
#X text 106 195 length of first stage;
#X obj 272 253 ../uzi_sjf, f 6;
#X obj 271 317 expr pow(2 \, $f1)*$f2;
#X obj 273 216 t b f b, f 11;
#X obj 455 316 value \$0-glchannels;
#X obj 271 341 /, f 23;
#X obj 272 294 t f f, f 56;
#X obj 665 333 outlet;
#X obj 271 365 t f f, f 19;
#X obj 273 121 change;
#X connect 0 0 11 0;
#X connect 1 0 6 0;
#X connect 2 0 3 1;
#X connect 2 0 9 2;
#X connect 3 0 4 0;
#X connect 4 2 8 0;
#X connect 5 0 7 0;
#X connect 6 0 3 0;
#X connect 6 1 5 1;
#X connect 6 1 9 1;
#X connect 6 2 0 1;
#X connect 7 0 10 0;
#X connect 8 0 5 0;
#X connect 8 1 9 0;
#X connect 9 0 7 1;
#X connect 10 0 0 0;
#X connect 12 0 16 0;
#X connect 13 0 14 0;
#X connect 14 0 32 0;
#X connect 15 0 16 0;
#X connect 16 0 13 0;
#X connect 17 0 21 0;
#X connect 17 1 18 0;
#X connect 18 0 19 0;
#X connect 18 0 24 1;
#X connect 19 0 20 0;
#X connect 19 0 21 1;
#X connect 21 0 22 0;
#X connect 22 0 26 0;
#X connect 24 2 29 0;
#X connect 25 0 28 0;
#X connect 26 0 24 0;
#X connect 26 1 25 1;
#X connect 26 2 27 0;
#X connect 27 0 28 1;
#X connect 27 0 2 0;
#X connect 28 0 31 0;
#X connect 29 0 25 0;
#X connect 29 1 30 0;
#X connect 31 0 1 0;
#X connect 32 0 17 0;
#X restore 94 75 pd arrangeEarlyReflectionDelayTimes;
#X obj 94 136 t f b;
#X obj 128 161 +;
#X obj 161 162 + 1;
#X msg 153 126 0;
#X obj 94 20 inlet;
#X obj 110 246 tabwrite dummy;
#X obj 301 166 pack 0 \$0;
#X msg 301 193 set \$2-glDel\$1;
#X obj 177 16 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 235 116 t b f;
#X connect 0 0 1 0;
#X connect 0 1 10 0;
#X connect 1 0 6 0;
#X connect 1 1 2 0;
#X connect 2 0 3 0;
#X connect 2 0 6 1;
#X connect 3 0 2 1;
#X connect 4 0 2 1;
#X connect 5 0 0 0;
#X connect 7 0 8 0;
#X connect 8 0 6 0;
#X connect 9 0 0 0;
#X connect 10 0 4 0;
#X connect 10 1 7 0;
#X restore 250 82 pd calculateERglDelayTimes;
#X obj 38 53 t b b b, f 29;
#X obj 164 14 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X connect 0 0 3 0;
#X connect 3 0 1 0;
#X connect 3 2 2 0;
#X connect 4 0 3 0;
#X restore 440 258 pd gldelayTimes;
#X obj 526 475 array define dummy 1;
#X obj 27 174 geraintLuff/glDiffuser8_sjf~ 0 \$0 \$0-glDel0;
#X obj 28 218 geraintLuff/glDiffuser8_sjf~ 1 \$0 \$0-glDel1;
#X obj 29 259 geraintLuff/glDiffuser8_sjf~ 2 \$0 \$0-glDel2;
#X obj 28 300 geraintLuff/glDiffuser8_sjf~ 3 \$0 \$0-glDel3;
#X connect 0 0 1 0;
#X connect 1 0 23 0;
#X connect 1 0 23 1;
#X connect 1 0 23 2;
#X connect 1 0 23 3;
#X connect 1 0 23 4;
#X connect 1 0 23 5;
#X connect 1 0 23 6;
#X connect 1 0 23 7;
#X connect 2 0 4 1;
#X connect 4 0 5 0;
#X connect 6 0 10 0;
#X connect 7 0 8 0;
#X connect 8 0 9 0;
#X connect 10 0 11 0;
#X connect 10 1 12 0;
#X connect 11 0 13 0;
#X connect 11 0 15 0;
#X connect 12 0 14 0;
#X connect 12 0 15 1;
#X connect 15 0 16 0;
#X connect 23 0 24 0;
#X connect 23 1 24 1;
#X connect 23 2 24 2;
#X connect 23 3 24 3;
#X connect 23 4 24 4;
#X connect 23 5 24 5;
#X connect 23 6 24 6;
#X connect 23 7 24 7;
#X connect 24 0 25 0;
#X connect 24 1 25 1;
#X connect 24 2 25 2;
#X connect 24 3 25 3;
#X connect 24 4 25 4;
#X connect 24 5 25 5;
#X connect 24 6 25 6;
#X connect 24 7 25 7;
#X connect 25 0 26 0;
#X connect 25 1 26 1;
#X connect 25 2 26 2;
#X connect 25 3 26 3;
#X connect 25 4 26 4;
#X connect 25 5 26 5;
#X connect 25 6 26 6;
#X connect 25 7 26 7;
#X connect 26 0 4 0;
#X connect 26 1 4 0;
#X connect 26 2 4 0;
#X connect 26 3 4 0;
#X connect 26 4 4 0;
#X connect 26 5 4 0;
#X connect 26 6 4 0;
#X connect 26 7 4 0;
#X restore 277 222 pd diffusion_gl;
#X obj 260 34 r \$0-ertypesnd;
#X obj 91 277 outlet~;
#X connect 0 0 1 0;
#X connect 0 0 7 0;
#X connect 0 0 2 0;
#X connect 1 0 9 0;
#X connect 2 0 9 0;
#X connect 3 0 2 1;
#X connect 3 0 7 1;
#X connect 3 0 1 1;
#X connect 4 0 1 2;
#X connect 5 0 2 2;
#X connect 6 0 7 2;
#X connect 7 0 9 0;
#X connect 8 0 4 0;
#X connect 8 0 6 0;
#X connect 8 0 5 0;
#X restore 94 382 pd early;
#X connect 0 0 5 0;
#X connect 1 0 19 0;
#X connect 2 0 32 0;
#X connect 3 0 19 0;
#X connect 5 0 7 0;
#X connect 5 1 6 0;
#X connect 11 0 12 0;
#X connect 14 0 45 0;
#X connect 14 0 47 0;
#X connect 19 0 2 0;
#X connect 19 1 26 0;
#X connect 21 0 22 0;
#X connect 22 0 23 1;
#X connect 23 0 30 0;
#X connect 30 0 15 0;
#X connect 30 1 16 0;
#X connect 31 0 21 0;
#X connect 33 0 30 0;
#X connect 35 0 39 0;
#X connect 35 0 40 0;
#X connect 36 0 33 0;
#X connect 37 0 38 0;
#X connect 38 0 36 1;
#X connect 39 0 37 0;
#X connect 39 0 42 0;
#X connect 40 0 41 0;
#X connect 41 0 43 0;
#X connect 43 0 44 0;
#X connect 44 0 45 1;
#X connect 45 0 33 0;
#X connect 47 0 23 0;
#X connect 47 0 36 0;
#X coords 0 -1 1 1 200 250 1 10 10;
